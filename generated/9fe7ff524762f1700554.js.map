{"version":3,"sources":["webpack:///./client/lib/utils/user-agent.ts","webpack:///./client/lib/utils/request-idle-callback.ts","webpack:///./client/lib/utils/external-data.ts","webpack:///./client/lib/utils/strings.ts","webpack:///./client/lib/telemetry/index.ts","webpack:///./client/lib/utils/focuser.ts","webpack:///./client/lib/utils/random.ts","webpack:///./client/lib/telemetry/data-scrubber.ts","webpack:///./client/lib/telemetry/telemetry.ts","webpack:///./client/lib/telemetry/route-utils.ts","webpack:///./client/lib/utils/supports-auto-theme.ts","webpack:///./client/lib/utils/storage-manager.ts","webpack:///./client/lib/utils/go-up.ts","webpack:///./client/management/settings/user-interface/user-interface-settings-ui-store.ts","webpack:///./client/lib/utils/supports-touch.ts","webpack:///./client/lib/telemetry/logger.ts","webpack:///./client/management/stores/settings/user-interface-settings-store.ts","webpack:///./client/lib/telemetry/metrics.ts","webpack:///./client/lib/sentry.ts","webpack:///./client/lib/utils/safe-local-storage.ts","webpack:///./client/lib/utils/os-utils.ts","webpack:///./client/lib/utils/config.ts"],"names":["getOsFromUserAgent","parsedOs","uaParser","UAParser","getOS","osName","name","toLowerCase","startsWith","supportsTouch","OS","IOS","split","browser","getBrowser","browserName","indexOf","fn","options","window","setTimeout","ExternalDataState","initialState","Pending","this","state","Loaded","Failed","setState","load","dataPromise","transform","data","undefined","error","then","result","runInAction","catch","action","err","loadVoid","noop","loadInBackground","loadInBackgroundVoid","observable","computed","DEPRECATED_DO_NOT_USE_SEE_DOC_COMMENT_ExternalDataStore","replaceSpacesWithDashes","str","replace","RouteUtils","telemetry","Telemetry","container","onFocused","force","tabbableElements","tabbable","includeContainer","elementToFocus","find","element","HTMLElement","getAttribute","focus","hasTabIndex","hasAttribute","prevTabIndex","tabIndex","removeAttribute","random","crypto","Math","array","Uint32Array","getRandomValues","params","apps","azure_subscriptions","branches","builds","collaborators","crashes","events","orgs","releases","teams","users","distribution_groups","regExp","RegExp","Object","keys","join","replacer","match","p1","lowerGroup","path","indexOfQuery","substr","beacon","commit","initProps","config","init","setUser","user","account","email","domain","last","internalUser","userOrigin","origin","setAppStoreContext","appStore","startTrackingPaidApps","billingNotifiers","setPathContext","getBeacon","app","props","scrubPath","appId","id","appOrigin","isPaid","os","platform","getPlatform","microsoft_internal","extractBeaconFromPath","location","host","some","notifier","extractPathTempate","routes","map","route","slice","length","filter","DefaultBeacon","matchMedia","matches","navigator","appVersion","includes","userId","beaconName","_storageKey","getObject","key","_getContext","saveObject","value","context","_saveContext","safeLocalStorage","getItem","JSON","parse","setItem","stringify","StorageManager","goUp","router","preserveQuery","lastRoute","pop","lastRouteChunkLength","locationChunks","pathname","backPath","push","search","InterfaceSettingsStoreContext","createObservableContext","selectThemeOption","themeValue","userInterfaceSettingsStore","setTheme","updateToggle","e","target","checked","previousTheme","theme","isAutoSelected","supportsAutoTheme","InterfaceSettingsStore","maxTouchPoints","msMaxTouchPoints","TouchEvent","LogLevel","emitters","level","message","properties","method","console","debug","Info","info","Warn","warn","Error","call","arg","log","forEach","emmiter","assign","commonProperties","logger","verbose","Verbose","prevThemeValue","effectiveTheme","UserInterfaceSettingsStore","metrics","emitMetric","dimensions","hasStacktrace","event","exception","values","valueException","stacktrace","frames","frame","lineno","Sentry","dsn","allowUrls","ignoreErrors","denyUrls","release","environment","env","maxBreadcrumbs","beforeBreadcrumb","breadcrumb","hint","url","type","beforeSend","request","configureScope","scope","raiseFakeSentryException","captureException","_storage","clear","index","removeItem","SafeLocalStorage","safeStorage","localStorage","MACOS","ANDROID","WINDOWS","LINUX","CONFIG_KEYS","configuration","get","getEnv","getApiGatewayUrl","getApiGatewayUrlInstall","getCookieDomain","getEnforceRegisterRedirect","getAppInsightsInstrumentationKey","getRootPathsNotInNav","getAccountManagementUrl","getClientId"],"mappings":"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","file":"9fe7ff524762f1700554.js","sourcesContent":["import { OS } from \"@lib/common-interfaces/app\";\nimport * as uaParser from \"ua-parser-js\";\nimport { supportsTouch } from \"./supports-touch\";\n\nexport function getOsNameFromUserAgent(): string {\n  const parsedOs = getOsFromUserAgent();\n  const osStrings: string[] = parsedOs.name ? parsedOs.name.split(\" \") : [];\n  return osStrings[0] || \"\";\n}\n\nexport function getOsFromUserAgent(): IUAParser.IOS {\n  const parser = new uaParser.UAParser();\n  const parsedOs = parser.getOS();\n  let osName = parsedOs.name;\n\n  // if OS is \"Mac OS\" from user agent, and if the device supports touch, then its an iOS (ipad or iphone)\n  // this is to fix an issue in iPadOS 13 where safari's default user agent returns \"Mac OS\" as OS name.\n  if (osName && osName.toLowerCase().startsWith(\"mac\") && supportsTouch()) {\n    osName = OS.IOS;\n  }\n\n  return { ...parsedOs, name: osName || \"\" };\n}\n\nexport function getBrowserFromUserAgent(): IUAParser.IBrowser {\n  const parser = new uaParser.UAParser();\n  const browser = parser.getBrowser();\n  let browserName = browser.name;\n\n  // iPadOS 13's Safari now opens in desktop mode by default, and in this mode, the user agent has \"Safari\" as browser name.\n  // which is different than iOS 12 where Safari's user agent had \"Mobile Safari\" as browser name.\n  // use supportsTouch() util to return the correct compatible browser name.\n  if (browserName && browserName.toLowerCase().indexOf(\"safari\") !== -1 && supportsTouch()) {\n    browserName = \"Mobile Safari\";\n  }\n\n  return { ...browser, name: browserName };\n}\n","export function requestIdleCallback(fn: Function, options?: { timeout?: number }) {\n  if (window[\"requestIdleCallback\"]) {\n    // @ts-ignore\n    window[\"requestIdleCallback\"](fn, options);\n  } else {\n    setTimeout(fn, 0);\n  }\n}\n","//\n// Abstract class and data structures for dealing with\n// external data - data loaded asynchronously, where\n// we need to track if it's been loaded, and if the load\n// succeeded.\n//\n// External data is in one of three states:\n//\n//  - Pending: the data has been requested and we're waiting for a result\n//  - Loaded: The data has been recieved and is available\n//  - Failed: The retrieval has failed, error information is available.\n//\n\nimport { observable, action, computed, runInAction } from \"mobx\";\nimport { noop } from \"lodash\";\n\nexport enum ExternalDataState {\n  Idle,\n  Pending,\n  Loaded,\n  Failed,\n}\n\nexport interface ExternalData<T> {\n  state: ExternalDataState;\n  data?: T;\n  error?: ExternalDataError;\n}\n\nexport interface ExternalDataError extends Error {\n  status?: number;\n}\n\n//\n// ExternalDataStore is exposes a class with a 'state' field.\n// The object looks like this in the various states:\n//\n// Pending: { state: 'pending' }\n// Loaded:  { state: 'loaded', data: ... }\n// Failed:  { state: 'failed', error: <JS Error object> }\n//\n/**\n * DO NOT USE THIS TYPE! This is a legacy class and should NOT be used for any new work. Your PR will be rejected if you create a new implementation of ExternalDataStore.\n *\n * Please contact the Core UX team on Slack (#appcenter-portal) if you have further questions.\n *\n * @deprecated\n * Use the Data Layer instead, more info here: https://dev.azure.com/msmobilecenter/Mobile-Center/_git/appcenter?path=%2Fux%2Fportal%2Fclient%2Fdata%2FREADME.md&version=GBmaster\n */\nexport abstract class DEPRECATED_DO_NOT_USE_SEE_DOC_COMMENT_ExternalDataStore<T> implements ExternalData<T> {\n  @observable\n  public state: ExternalDataState;\n\n  @observable\n  public data?: T;\n\n  @observable\n  public error?: ExternalDataError;\n\n  constructor(initialState = ExternalDataState.Pending) {\n    this.state = initialState;\n  }\n\n  @computed\n  get isPending() {\n    return this.state === ExternalDataState.Pending;\n  }\n\n  @computed\n  get isLoaded() {\n    return this.state === ExternalDataState.Loaded;\n  }\n\n  @computed\n  get isFailed() {\n    return this.state === ExternalDataState.Failed;\n  }\n\n  @action\n  protected setState(state: ExternalDataState) {\n    this.state = state;\n  }\n\n  /**\n   * Optionaly convenience method for loading the data asynchronously and updating\n   * the state correctly. Alternatively you can implement this logic yourself\n   *\n   * @param {Promise<T>} [dataPromise] The promise you want state updated for.\n   * @param {Function} [transform] The function to pass the results of the Promise to.\n   *   The return value of this function will be assigned to `data`.\n   * @returns {Promise<T>}\n   */\n  @action\n  protected load(dataPromise: Promise<T>, transform?: (result: T) => T): Promise<T> {\n    this.state = ExternalDataState.Pending;\n    this.data = undefined;\n    this.error = undefined;\n    return dataPromise\n      .then((result: T) => {\n        runInAction(() => {\n          if (this.state === ExternalDataState.Pending) {\n            if (transform) {\n              this.data = transform(result);\n            } else {\n              this.data = result;\n            }\n            this.state = ExternalDataState.Loaded;\n          }\n        });\n\n        return result;\n      })\n      .catch(\n        action((err: Error) => {\n          if (this.state === ExternalDataState.Pending) {\n            this.state = ExternalDataState.Failed;\n            this.error = err;\n          }\n          throw err;\n        })\n      );\n  }\n\n  /**\n   * Alias of load() that does not return/throw\n   *\n   * Method load() mixes two patterns. It modifies observeable data but also returns/throws. Most of the\n   * callers do not handle the response, resulting into unhandled rejections flooding our telemetry.\n   *\n   * Method loadVoid() wraps load() and does not return/throw.\n   * We are migrating callers of load() one by one. Once everything is migrated, loadVoid() will become load().\n   */\n  protected loadVoid(dataPromise: Promise<T>, transform?: (result: T) => T): Promise<void> {\n    return this.load(dataPromise, transform).then(noop).catch(noop);\n  }\n\n  /**\n   * Optionaly convenience method for loading the data asynchronously and updating\n   * the state correctly. Alternatively you can implement this logic yourself\n   *\n   * Differs from `load` in that it does not reset the state to Pending and clear the `data`.\n   *\n   * @param {Promise<T>} [dataPromise] The promise you want state updated for.\n   * @param {Function} [transform] The function to pass the results of the Promise to.\n   *   The return value of this function will be assigned to `data`.\n   * @returns {Promise<T>}\n   */\n  @action\n  protected loadInBackground(dataPromise: Promise<T>, transform?: (result: T) => T): Promise<T> {\n    return dataPromise\n      .then((result: T) => {\n        runInAction(() => {\n          if (transform) {\n            this.data = transform(result);\n          } else {\n            this.data = result;\n          }\n          this.state = ExternalDataState.Loaded;\n          this.error = undefined;\n        });\n\n        return this.data!;\n      })\n      .catch(\n        action((err: Error) => {\n          this.state = ExternalDataState.Failed;\n          this.error = err;\n          throw err;\n        })\n      );\n  }\n\n  /**\n   * Alias of loadInBackground() that does not return/throw\n   *\n   * Method loadInBackground() mixes two patterns. It modifies observeable data but also returns/throws. Most of the\n   * callers do not handle the response, resulting into unhandled rejections flooding our telemetry.\n   *\n   * Method loadInBackgroundVoid() wraps loadInBackground() and does not return/throw.\n   * We are migrating callers of loadInBackground() one by one. Once everything is migrated, loadInBackgroundVoid() will become loadInBackground().\n   */\n  protected loadInBackgroundVoid(dataPromise: Promise<T>, transform?: (result: T) => T): Promise<void> {\n    return this.loadInBackground(dataPromise, transform).then(noop).catch(noop);\n  }\n}\n","export const replaceSpacesWithDashes = (str: string) => str.replace(/\\s+/g, '-');\n","export * from \"./data-scrubber\";\nexport * from \"./logger\";\nexport * from \"./metrics\";\nexport { RouteUtils } from \"./route-utils\";\nexport { telemetry, Telemetry } from \"./telemetry\";\n","import * as tabbable from \"tabbable\";\n\nexport function doFocus(container: HTMLElement, onFocused?: (element: HTMLElement) => void, force?: boolean): void {\n  const tabbableElements: Element[] = tabbable(container, { includeContainer: true });\n  const firstFocusable = tabbableElements.find(\n    (element) => element !== container && element instanceof HTMLElement && element.getAttribute(\"data-autofocus\") !== \"false\"\n  ) as HTMLElement;\n\n  // Focus container as a last resort\n  const elementToFocus = firstFocusable || (tabbableElements[0] === container ? container : null);\n  if (elementToFocus) {\n    elementToFocus.focus();\n    if (onFocused) {\n      onFocused(elementToFocus);\n    }\n  } else if (force) {\n    const hasTabIndex = container.hasAttribute(\"tabindex\");\n    const prevTabIndex = hasTabIndex ? container.tabIndex : undefined;\n    container.tabIndex = 1;\n    container.focus();\n    if (hasTabIndex && typeof prevTabIndex === \"number\") {\n      container.tabIndex = prevTabIndex;\n    } else {\n      container.removeAttribute(\"tabindex\");\n    }\n\n    if (onFocused) {\n      onFocused(container);\n    }\n  }\n}\n","/**\n * Semi-secure random number generator.\n * Produces decimal values between 0 and 1, like 'Math.random', but uses 'Crypto.getRandomValues' when available.\n */\nexport const random = (): number => {\n  if (!window.crypto) {\n    // tslint:disable-next-line:insecure-random\n    return Math.random();\n  }\n  const array = new Uint32Array(1);\n  window.crypto.getRandomValues(array);\n  return array[0] / (0xffffffff + 1);\n};\n","const params = {\n  apps: \"app_name\",\n  azure_subscriptions: \"azure_subscription_id\",\n  branches: \"branch\",\n  builds: \"build_id\",\n  \"code-push\": \"deployment\",\n  collaborators: \"user_id\",\n  \"crashes/groups\": \"crash_group_id\",\n  crashes: \"crash_id\",\n  \"distribution-groups\": \"group_name\",\n  events: \"event_name\",\n  orgs: \"owner_name\",\n  releases: \"release_id\",\n  teams: \"team_name\",\n  \"test/runs\": \"test_run_id\",\n  users: \"owner_name\",\n  distribution_groups: \"group_name\",\n};\n\nconst regExp = new RegExp(\n  \"/(\" + Object.keys(params).join(\"|\") + \")/(?!(create|new|new-group|new-release|groups|{owner_name})(/|$))[^/]+\",\n  \"ig\"\n);\n\nconst replacer = (match, p1: string) => {\n  const lowerGroup = p1.toLowerCase();\n  return `/${lowerGroup}/{${params[lowerGroup]}}`;\n};\n\nexport function scrubPath(path: string): string {\n  if (!path) {\n    return path;\n  }\n\n  // Trim query params\n  const indexOfQuery = path.indexOf(\"?\");\n  if (indexOfQuery > -1) {\n    path = path.substr(0, indexOfQuery);\n  }\n\n  path = path.replace(/\\/api\\/(v[0-9.]+)\\/apps\\/([^/]+)\\/([^/]+)\\//i, (match, p1: string) => {\n    return `/api/${p1}/apps/{owner_name}/{app_name}/`;\n  });\n  path = path.replace(regExp, replacer);\n\n  return path;\n}\n","declare const window: any;\n\nimport { scrubPath } from \"./data-scrubber\";\nimport { RouteUtils } from \"./route-utils\";\nimport { last, some } from \"lodash\";\nimport { IApp, IUser } from \"@lib/common-interfaces\";\n\nexport interface TelemetryAppStore {\n  app?: IApp;\n  apps: IApp[];\n}\n\nexport class Telemetry {\n  private commit: string;\n  private appStore?: TelemetryAppStore;\n  private path: string;\n  private internalUser?: boolean;\n  private userOrigin?: string;\n  private beacon: string;\n  private billingNotifiers?: { isPaid: boolean }[];\n\n  constructor() {\n    this.path = \"\";\n    this.beacon = \"\";\n    this.commit = (((window as any).initProps || {}).config || {}).commit || \"unknown\";\n  }\n\n  public init() {\n  }\n\n  public setUser(user: IUser, account?: string) {\n    if (user.email) {\n      const domain = last(user.email.split(\"@\"));\n      if (domain) {\n        this.internalUser = domain.toLowerCase() === \"microsoft.com\";\n      }\n    }\n\n    this.userOrigin = user.origin;\n  }\n\n  public setAppStoreContext(appStore: TelemetryAppStore) {\n    this.appStore = appStore;\n  }\n\n  /**\n   * Begins tracking whether the current app has been paid for.\n   */\n  public startTrackingPaidApps(billingNotifiers: { isPaid: boolean }[]) {\n    this.billingNotifiers = billingNotifiers;\n  }\n\n  public setPathContext(path: string) {\n    this.path = path;\n    this.beacon = this.getBeacon(path);\n  }\n\n  public get commonProperties() {\n    const app = this.appStore && this.appStore.app;\n    const props = {\n      beacon: this.beacon,\n      path: scrubPath(this.path),\n      appId: app && app.id,\n      internalUser: this.internalUser,\n      commit: this.commit,\n      appOrigin: app && app.origin,\n      isPaid: this.isPaid(),\n      userOrigin: this.userOrigin,\n    };\n\n    const os = this.getOS();\n    if (os) {\n      props[\"os\"] = os;\n    }\n\n    const platform = this.getPlatform();\n    if (platform) {\n      props[\"platform\"] = platform;\n    }\n\n    if (app && app.microsoft_internal) {\n      // track whether or not the current app is enabled for MS-internal dogfooding\n      props[\"microsoftInternalApp\"] = true;\n    }\n\n    return props;\n  }\n\n  private getBeacon(path: string): string {\n    return RouteUtils.extractBeaconFromPath(window.location.host, path);\n  }\n\n  private isPaid(): boolean | undefined {\n    if (this.billingNotifiers) {\n      // If there's paid for just _one_ plan, we're happy\n      if (some(this.billingNotifiers, (notifier) => notifier.isPaid)) {\n        return true;\n      }\n      // If there are still plans we don't know about, the result is undefined\n      if (some(this.billingNotifiers, (notifier) => notifier.isPaid === undefined)) {\n        return undefined;\n      }\n\n      return false;\n    }\n\n    return undefined;\n  }\n\n  private getOS(): string | undefined {\n    if (this.appStore && this.appStore.app) {\n      return this.appStore.app.os;\n    }\n  }\n\n  private getPlatform(): string | undefined {\n    if (this.appStore && this.appStore.app) {\n      return this.appStore.app.platform;\n    }\n  }\n}\n\nexport const telemetry = new Telemetry();\n","import { PlainRoute } from \"react-router\";\n\nexport class RouteUtils {\n  public static DefaultBeacon = \"manage\";\n\n  public static extractPathTempate(routes: PlainRoute[]): string {\n    const pathTemplate: string = routes\n      .map((route) => {\n        let path: string = route[\"path\"] || \"\";\n\n        if (path[0] === \"/\") {\n          path = path.slice(1);\n        }\n\n        if (path[path.length - 1] === \"/\") {\n          path = path.slice(0, -1);\n        }\n\n        return path;\n      })\n      .filter((path) => {\n        return path && path !== \"/\";\n      })\n      .join(\"/\");\n\n    return \"/\" + pathTemplate;\n  }\n\n  public static extractBeaconFromPath(host: string, path: string): string {\n    if (host && host.split(\".\")[0].toLowerCase() === \"install\") {\n      return \"install\";\n    }\n\n    if (!path) {\n      return this.DefaultBeacon;\n    }\n\n    if (path.indexOf(\"/github-app/\") === 0) {\n      return \"github-app\";\n    }\n\n    const beacon = path.match(/\\/(?:users|orgs)\\/[^\\/]+\\/apps\\/[^\\/]+\\/([^\\/]+)/i);\n    if (beacon && beacon.length > 1) {\n      return beacon[1].toLowerCase();\n    } else {\n      return this.DefaultBeacon;\n    }\n  }\n}\n","export function supportsAutoTheme(): boolean {\n  return window.matchMedia(\"(prefers-color-scheme)\").matches && !navigator.appVersion.includes(\"Edge/\");\n}\n","import { safeLocalStorage } from \"./safe-local-storage\";\n\n/**\n * A wrapper around `localStorage` that manages a common context object\n * for a given beacon.\n */\nexport class StorageManager {\n  private _storageKey: string;\n\n  constructor(userId: string | undefined, beaconName: string) {\n    this._storageKey = !!userId ? `ac/${userId}/${beaconName}` : `ac/${beaconName}`;\n  }\n\n  /**\n   * Get an object from a given key.\n   */\n  public getObject(key: string): any {\n    return this._getContext()[key];\n  }\n\n  /**\n   * Save object at the given key.\n   */\n  public saveObject(key: string, value: any) {\n    const context = this._getContext();\n    context[key] = value;\n    this._saveContext(context);\n  }\n\n  /**\n   * Get global context object from local storage.\n   */\n  private _getContext(): any {\n    const context = safeLocalStorage.getItem(this._storageKey);\n    return context ? JSON.parse(context) : {};\n  }\n\n  /**\n   * Save the given context object to local storage.\n   */\n  private _saveContext(context: any) {\n    safeLocalStorage.setItem(this._storageKey, JSON.stringify(context));\n  }\n}\n","import { InjectedRouter, PlainRoute } from \"react-router\";\n\n/**\n * Navigates up a route, e.g. from /beacon/users/123 to /beacon/users\n */\nexport const goUp = (\n  router: InjectedRouter,\n  routes: PlainRoute[],\n  location: { pathname: string; search: string },\n  preserveQuery = true\n) => {\n  const lastRoute = routes.slice(-1).pop();\n  const lastRouteChunkLength = (lastRoute && lastRoute.path && lastRoute.path.split(\"/\").length) || 0;\n  const locationChunks = location.pathname.split(\"/\");\n  const backPath = locationChunks.slice(0, locationChunks.length - lastRouteChunkLength).join(\"/\");\n  router.push(backPath + (preserveQuery ? location.search : \"\"));\n};\n","import { action, computed } from \"mobx\";\nimport { createObservableContext } from \"@root/shared/utils/create-observable-context\";\nimport { ThemeOptions, userInterfaceSettingsStore } from \"@root/management/stores/settings/user-interface-settings-store\";\nimport { supportsAutoTheme } from \"@root/lib/utils/supports-auto-theme\";\n\nexport const InterfaceSettingsStoreContext = createObservableContext<InterfaceSettingsStore>(null as any);\n\nexport class InterfaceSettingsStore {\n  @action\n  public selectThemeOption = (themeValue: ThemeOptions) => {\n    userInterfaceSettingsStore.setTheme(themeValue);\n  };\n\n  @action\n  public updateToggle = (e: React.ChangeEvent<HTMLInputElement>) => {\n    userInterfaceSettingsStore.setTheme(e.target.checked ? \"auto\" : userInterfaceSettingsStore.previousTheme);\n  };\n\n  @computed get themeValue(): ThemeOptions {\n    return userInterfaceSettingsStore.theme;\n  }\n\n  @computed get effectiveTheme(): ThemeOptions {\n    if (this.isAutoSelected) {\n      const x = window.matchMedia(\"(prefers-color-scheme: dark)\");\n      if (x.matches) {\n        return \"dark\";\n      } else {\n        return \"light\";\n      }\n    }\n\n    return this.themeValue;\n  }\n\n  @computed get supportsAutoTheme() {\n    return supportsAutoTheme();\n  }\n\n  @computed get isAutoSelected() {\n    return userInterfaceSettingsStore.theme === \"auto\";\n  }\n}\n","export function supportsTouch(): boolean {\n  // @ts-ignore\n  return (\"ontouchstart\" in window || navigator.maxTouchPoints > 0 || navigator.msMaxTouchPoints > 0) && !!window.TouchEvent;\n}\n","import { telemetry } from \"./telemetry\";\n\nexport type LogProperties = { [key: string]: string | string[] | number | boolean | undefined };\n\n// Levels aligned with @appcenter/telemetry library. Critical and Fatal missing here.\nenum LogLevel {\n  Error = 3,\n  Warn,\n  Info,\n  Verbose,\n}\n\ninterface LogEmitter {\n  (level: LogLevel, message: string, error: Error | undefined, properties: LogProperties): void;\n}\n\nconst consoleEmitter: LogEmitter = (level: LogLevel, message: string, error: Error | undefined, properties: LogProperties): void => {\n  let method = console.debug;\n\n  switch (level) {\n    case LogLevel.Info:\n      method = console.info;\n      break;\n    case LogLevel.Warn:\n      method = console.warn;\n      break;\n    case LogLevel.Error:\n      method = console.error;\n      break;\n  }\n\n  method.call(console, ...[message, error, properties].filter((arg) => !!arg));\n};\n\nconst emitters: LogEmitter[] = [consoleEmitter];\n\nfunction log(level: LogLevel, message: string, error: Error | undefined, properties: LogProperties | undefined) {\n  emitters.forEach((emmiter) => emmiter(level, message, error, Object.assign({}, telemetry.commonProperties, properties)));\n}\n\nexport namespace logger {\n  /**\n   * Console-only message\n   *\n   * Not sent to Geneva. Local debugging only.\n   */\n  export function verbose(message: string, properties?: LogProperties) {\n    log(LogLevel.Verbose, message, undefined, properties);\n  }\n\n  /**\n   * Event\n   *\n   * Use for significant events that you want to analyse in Geneva.\n   */\n  export function info(message: string, properties?: LogProperties) {\n    log(LogLevel.Info, message, undefined, properties);\n  }\n\n  /**\n   * Handled error\n   *\n   * Use for errors that should not involve DRI.\n   */\n  export function warn(message: string, error?: Error | undefined, properties?: LogProperties) {\n    log(LogLevel.Warn, message, error, properties);\n  }\n\n  /**\n   * Unhandled error\n   *\n   * Use for errors that should involve DRI.\n   */\n  export function error(message: string, error?: Error | undefined, properties?: LogProperties) {\n    log(LogLevel.Error, message, error, properties);\n  }\n}\n","import { action, observable, computed } from \"mobx\";\nimport { safeLocalStorage } from \"@root/lib/utils/safe-local-storage\";\nimport { logger } from \"@root/lib/telemetry\";\nimport { supportsAutoTheme } from \"@root/lib/utils/supports-auto-theme\";\n\nexport type ThemeOptions = \"auto\" | PreviousThemeOptions;\nexport type PreviousThemeOptions = \"light\" | \"dark\";\nclass UserInterfaceSettingsStore {\n  @observable private themeValue: ThemeOptions;\n  private prevThemeValue?: PreviousThemeOptions;\n\n  constructor() {\n    this.themeValue = (safeLocalStorage.getItem(\"theme-value\") as ThemeOptions) || (supportsAutoTheme() ? \"auto\" : \"light\");\n    this.prevThemeValue = safeLocalStorage.getItem(\"previous-theme-value\") as PreviousThemeOptions;\n  }\n\n  @computed get theme(): ThemeOptions {\n    return this.themeValue;\n  }\n\n  get previousTheme(): PreviousThemeOptions {\n    return this.prevThemeValue || \"light\";\n  }\n\n  @action setTheme = (theme: ThemeOptions) => {\n    if (theme !== \"auto\") {\n      safeLocalStorage.setItem(\"previous-theme-value\", theme);\n      this.prevThemeValue = theme;\n      logger.info(\"theme-selected\", { theme, effectiveTheme: theme });\n    } else {\n      logger.info(\"theme-selected\", { theme, effectiveTheme: this.prevThemeValue });\n    }\n    safeLocalStorage.setItem(\"theme-value\", theme);\n    this.themeValue = theme;\n  };\n}\n\nexport const userInterfaceSettingsStore = new UserInterfaceSettingsStore();\n","export namespace metrics {\n  export function emitMetric(name: string, value: number, dimensions?: { [key: string]: string }) {\n  }\n}\n","declare const window: any;\n\nimport * as Sentry from \"@sentry/react\";\nimport { scrubPath } from \"./telemetry\";\n\nconst config = window && window.initProps && window.initProps.config ? window.initProps.config : {};\n\nexport function startSentry() {\n  Sentry.init({\n    dsn: \"https://3ffeb3ea8fcf4d35af413cad17c4e9db@o205451.ingest.sentry.io/5314820\",\n    allowUrls: [\"assets.appcenter.ms\", \"assets.dev-pme.avalanch.es\"],\n    ignoreErrors: [\n      // Random plugins/extensions\n      \"top.GLOBALS\",\n    ],\n    denyUrls: [\n      // Chrome extensions\n      /extensions\\//i,\n      /^chrome:\\/\\//i,\n    ],\n    release: config.commit,\n    environment: config.env,\n    maxBreadcrumbs: 100,\n    beforeBreadcrumb(breadcrumb, hint) {\n      if (breadcrumb.data && breadcrumb.data[\"url\"]) {\n        breadcrumb.data.url = scrubPath(breadcrumb.data.url);\n      }\n      // Only send breadcrumbs that are requests\n      if (breadcrumb.type === \"http\") {\n        return breadcrumb;\n      }\n      return null;\n    },\n    beforeSend(event) {\n      if (!hasStacktrace(event)) {\n        return null;\n      }\n      if (event.request?.url) {\n        event.request.url = scrubPath(event.request.url);\n      }\n      return event;\n    },\n  });\n\n  Sentry.configureScope(function (scope) {\n    if (window.initProps.user) {\n      scope.setUser({ id: window.initProps.user.id });\n    }\n  });\n}\n\n/**\n * Does the event have any errors with a stacktrace?\n *\n * Browsers discard stacktrace i.e. when under memory pressure.\n * @param event Sentry Event\n * @returns True if the event has an error with a stacktrace with at least two frames with a line number\n */\nexport function hasStacktrace(event: Partial<Sentry.Event>): boolean {\n  if (!event.exception) {\n    return false;\n  }\n  return (\n    !!event.exception.values &&\n    event.exception.values.filter(\n      (valueException) =>\n        !!valueException.stacktrace &&\n        !!valueException.stacktrace.frames &&\n        valueException.stacktrace.frames.filter((frame) => !!frame.lineno).length > 1\n    ).length > 0\n  );\n}\n\nwindow.raiseFakeSentryException = () => {\n  Sentry.captureException(new Error(\"This appears in Sentry\"));\n};\n","export class SafeLocalStorage {\n  private _storage: Object;\n\n  constructor() {\n    this._storage = {};\n  }\n\n  public get length(): number {\n    return Object.keys(this._storage).length;\n  }\n\n  public clear(): void {\n    this._storage = {};\n  }\n\n  public getItem(key: string): string | null {\n    return this._storage[key];\n  }\n\n  public key(index: number): string | null {\n    return Object.keys(this._storage)[index];\n  }\n\n  public removeItem(key: string): void {\n    delete this._storage[key];\n  }\n\n  public setItem(key: string, data: string): void {\n    console.warn(\"Oops! Since localStorage isn't available in your browser, this data will not be persisted.\");\n    this._storage[key] = data;\n  }\n}\nconst safeStorage = new SafeLocalStorage();\n\nexport type LocalStorage = Storage | SafeLocalStorage;\nexport const safeLocalStorage: LocalStorage = (() => {\n  try {\n    const localStorage: Storage = window.localStorage;\n    localStorage.setItem(\"mcTest\", \"mc\");\n    localStorage.getItem(\"mcTest\");\n    localStorage.removeItem(\"mcTest\");\n    return localStorage;\n  } catch (e) {\n    console.warn(\n      \"Oops! Looks like localStorage isn't available in your browser. Please update your browser settings to turn on localStorage.\"\n    );\n    return safeStorage;\n  }\n})();\n","import { OS } from \"@lib/common-interfaces/app\";\n\nexport function isIos(os: string | undefined): boolean {\n  return !!os && os.toLowerCase() === OS.IOS.toLowerCase();\n}\n\nexport function isMacOS(os: string | undefined): boolean {\n  return !!os && os.toLowerCase() === OS.MACOS.toLowerCase();\n}\n\nexport function isAndroid(os: string | undefined): boolean {\n  return !!os && os.toLowerCase() === OS.ANDROID.toLowerCase();\n}\n\nexport function isWindows(os: string | undefined): boolean {\n  return !!os && os.toLowerCase().startsWith(OS.WINDOWS.toLowerCase());\n}\n\nexport function isLinux(os: string | undefined): boolean {\n  return !!os && os.toLowerCase().startsWith(OS.LINUX.toLowerCase());\n}\n","const CONFIG_KEYS = {\n  BIFROST_HOST: \"bifrostHost\",\n  BIFROST_INSTALL_HOST: \"bifrostInstallHost\",\n  ENV: \"env\",\n  ROOT_PATHS_NOT_IN_NAV: \"rootPathsNotInNav\",\n  ENFORCE_REGISTER_REDIRECT: \"enforceRegisterRedirect\",\n  AI_INSTRUMENTATION_KEY: \"aiInstrumentationKey\",\n  HOST: \"host\",\n  ACCOUNT_MANAGEMENT_URL: \"accountManagementUrl\",\n  CLIENT_ID: \"clientId\",\n};\n\n// Load configuration from window.\nconst configuration = ((window as any).initProps || {}).config || {};\n\nexport const config = {\n  get(key: string): any {\n    return configuration[key];\n  },\n\n  getEnv(): string {\n    return config.get(CONFIG_KEYS.ENV);\n  },\n\n  getApiGatewayUrl(): string {\n    return config.get(CONFIG_KEYS.BIFROST_HOST);\n  },\n\n  getApiGatewayUrlInstall(): string {\n    return config.get(CONFIG_KEYS.BIFROST_INSTALL_HOST);\n  },\n\n  getCookieDomain(): string {\n    return config.get(CONFIG_KEYS.HOST);\n  },\n\n  getEnforceRegisterRedirect(): string {\n    return config.get(CONFIG_KEYS.ENFORCE_REGISTER_REDIRECT);\n  },\n\n  getAppInsightsInstrumentationKey(): string {\n    return config.get(CONFIG_KEYS.AI_INSTRUMENTATION_KEY);\n  },\n\n  getRootPathsNotInNav(): string[] {\n    return config.get(CONFIG_KEYS.ROOT_PATHS_NOT_IN_NAV);\n  },\n\n  getAccountManagementUrl(): string {\n    return config.get(CONFIG_KEYS.ACCOUNT_MANAGEMENT_URL);\n  },\n\n  getClientId(): string {\n    return config.get(CONFIG_KEYS.CLIENT_ID);\n  },\n};\n"],"sourceRoot":""}